.PHONY: all libarchive clean

all: $(OBJECTS) $(SHLIB)

$(SHLIB): libarchive

libarchive-3.3.1/Makefile:
	(cd libarchive-3.3.1 && \
configure --enable-shared=no --enable-static=yes)

libarchive: libarchive-3.3.1/Makefile
	(cd libarchive-3.3.1 && \
make PREFIX="../" CC="$(CC)" CXX="$(CXX)" AR="$(AR)" ARFLAGS=$(ARFLAGS) libarchive.la)

clean:
	(cd libarchive-3.3.1 make clean)
	rm -f $(OBJECTS) $(SHLIB)
